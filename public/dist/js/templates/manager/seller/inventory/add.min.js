$(document).on("ready",function(){Dropzone.autoDiscover=!1;var a,b,c,d,e,f,g,h=s_lang.manager_inventory_add,j=!0,k=!1,l={},m=4,n=function(c,d){switch(j=!0,c){case 1:document.getElementById("listing_variation_select").innerHTML='<option value="var1"></option>',document.getElementById("image_variation_picker").innerHTML='<option value="var1"></option>',e=$("#pl_custom").val(),a={var1:{1:{}}},b={var1:{}},l={};break;case 2:$("#listing_variation_select, #image_variation_picker").empty(),e=3,a={current:{}},b={},l={};break;case 3:document.getElementById("listing_variation_select").innerHTML='<option value="var1"></option>',document.getElementById("image_variation_picker").innerHTML='<option value="var1"></option>',e=4,a={var1:{1:{}}},b={var1:{}},l={}}f=d},o=function(){var a={};return $.each($(".tab-content.variations .tab-pane"),function(){var c=$(this),d=c.find(".form-control.send"),e={combos:{},additional:{}};$.each(d,function(){if($(this).is("select")&&"other"==$(this).val())var a=$(this).next("input").val();else var a=$(this).val();if($(this).parents(".combination").length){var b=$(this).parents(".combination").data("combo");void 0==e.combos[b]&&(e.combos[b]={}),e.combos[b][$(this).data("var")]=a}else if($(this).parents(".additional-attribute-container").length){var c=$(this).parent("div").prev("div").find("input");e.additional[c.val()]=$(this).val()}else e[$(this).data("var")]="checkbox"==$(this).prop("type")?$(this).is(":checked")?2:1:a}),a[$(this).attr("id")]=e,a[$(this).attr("id")].images=b[$(this).attr("id")]}),a},p=function(){if($("#image_upload_problems").prop("checked"))return!0;if(0!=s.getUploadingFiles().length||0!=t.getUploadingFiles().length)return alertify.error("Please wait until all your files have finished uploading before finishing the wizard."),!1;var a=!0;return a},q=function(){var b=Object.keys(a).length,c=0,d="";return $.each(a,function(a,b){if(0==Object.keys(b).length){if(3!=e||"current"!=a)return alertify.alert("Please add conditions(s) for "+$('#listing_variation_select option[value="'+i+'"]').text()+" and click the Save button to save it."),!1;c++}else{var f=0,g=Object.keys(b).length;if($.each(b,function(b,c){return Object.keys(c).length>0?(f++,void $.each(c,function(c){var e=$('#listing_variation_select option[value="'+a+'"]'),f=$('#listing_combination_select option[value="'+b+'"]'),g=$('#listing_condition_select option[value="'+c+'"]'),h=a+"."+b+"."+c;d+='<option value="'+h+'">'+e.text()+" "+f.text()+" - "+g.text()+"</option>",l[h]?null:l[h]={}})):(alertify.alert("Please add at least one condition for each combination for "+$('#listing_variation_select option[value="'+a+'"]').text()+". If you do not currently have that item for listing, please go back to the previous tab and remove that combination."),!1)}),f!=g)return!1;c++}}),b==c?(document.getElementById("image_seller_picker").innerHTML=d,$("#image_seller_picker").trigger("change"),!0):!1},r=function(){$(".change-view").slideUp(),e=void 0,f=void 0};$("#productImages").dropzone(Sellyx.dz.init({url:"/corporate/master/products",accept:function(a,c){var d="variation"==g?b[$("#image_variation_picker").val()][a.name]:b[$("#image_variation_picker").val()][$("#image_final_picker").val()][a.name];void 0==d?c():(c("not happening"),alertify.error("You already added this file!"),this.removeFile(a))},init:function(){this.on("success",function(a,c){var d={name:c.success,size:a.size,existing:!1,variation:$("#image_variation_picker").val()};"variation"==g?b[$("#image_variation_picker").val()][a.name]=d:(d[g]=$("#image_final_picker").val(),b[$("#image_variation_picker").val()][$("#image_final_picker").val()][a.name]=d)}).on("removedfile",function(a){Sellyx.images.remove("variation"==g?b[$("#image_variation_picker").val()]:b[$("#image_variation_picker").val()][$("#image_final_picker").val()],"/corporate/master/products",a)})}})),$("#sellerImages").dropzone(Sellyx.dz.init({url:"/corporate/master/products",accept:function(a,b){void 0==l[$("#image_seller_picker").val()][a.name]?b():(b("not happening"),alertify.error("Oops! You already added this file for this product, combination and condition!"),this.removeFile(a))},init:function(){this.on("success",function(a,b){l[$("#image_seller_picker").val()][a.name]={name:b.success,size:a.size,existing:!1}}).on("removedfile",function(a){Sellyx.images.remove(l[$("#image_seller_picker").val()],"/corporate/master/products",a)})}}));var s=Dropzone.forElement("#productImages"),t=Dropzone.forElement("#sellerImages");$(document).on("click",".btn-prev",function(){$(".wizard .previous").click()}).on("click",".btn-next",function(){$(".wizard .next").click()}).on("change","#do_what",function(){r(),$("#search_view").find(".form-control").not($(this)).removeClass("send validate").parents(".form-group").slideUp(),1==$(this).val()?$("#pl_custom").addClass("send validate").parents(".form-group").slideDown().end().trigger("change"):Sellyx.ajax.standard({url:"inventory",failure:function(){$("#inventory_group").remove(),$("#do_what").val(1).trigger("change"),alertify.alert("Oops! It looks like you have no listed items yet. Let's get started on that!")},success:function(a){document.getElementById("inventory_items").innerHTML=Sellyx.generate.options(a),$("#inventory_items").addClass("send validate").parents(".form-group").slideDown()}})}).on("click",".add-inventory-variation",function(){$("#inventory_items option").length>0&&(n(2,$("#inventory_items option:selected").attr("value")),$(".wizard .next").click())}).on("change","#pl_custom",function(){r(),1==$(this).val()?$("#product_search").addClass("validate").parents(".form-group").slideDown():($("#product_search").removeClass("validate").parents(".form-group").slideUp(),$("#category_view").slideDown(),$("#1").trigger("change"))}).on("click",".go-back",function(){$("#search_view").slideDown();var a=$(this).parents(".change-view");a.prev(".change-view").show(),a.hide()}).on("click","#search_button",function(){var a=$("#product_search").val();return""==a.trim()?(alertify.alert("Oops! Please enter a search term first."),!1):void Sellyx.ajax.standard({url:"search",data:"&q="+a,before:function(){$("#tab1_results .results-message").text("Searching..."),$("#category_view , #search_table_container, #variations_table_container").slideUp(),$("#tab1_results").slideDown()},failure:function(){$("#tab1_results .results-message").text("There were no results for the search query. Search again or begin to add a new product by selecting a category above."),$("#category_view").slideDown(),$("#1").trigger("change")},success:function(a){$("#tab1_results .results-message").text(""),$.fn.DataTable.isDataTable("#searchTable")?$("#searchTable").DataTable().clear().rows.add(a).draw():$("#searchTable").dataTable(Sellyx.dt.init({data:a,ajax:!1,dom:"rtip",order:[[m,"asc"]],autoWidth:!1,columns:[{orderable:!1,data:"images","class":"center",width:"10%",render:function(a){if(a.label){var b=Object.keys(a.data)[0];return'<span>Available In Many Options</span><br/><img src="'+a.data[b][0].small+'"></img><br/><br/><span>Pictured Here <b>'+b+"</b></span>"}return'<img src="'+a.data[0].small+'"></img>'}},{orderable:!1,data:"name.data",width:"10%"},{orderable:!1,data:"description",width:"60%",render:function(a,b,c){return Sellyx.overflow({text:a,extra:"About "+c.name.label})}},{title:"Actions",orderable:!1,data:"category","class":"center",width:"20%",render:function(a,b,c){return'<a class="clickable see-variation">See Full Product</a><br /><br /><button class="btn btn-d-aqua add-this-variation">Add This '+c.name.label+'<i class="  fa fa-chevron-right right"></i></button></button><br />'}},{data:"line.id","class":"center"}],parent:{target:m,row:function(a){return'<tr class="group"><td class="center"><span>'+a.category.label+'</span></td><td colspan="2"><label>Available '+a.name.label+'(s) For</label><br/><span class="s-d-yellow">'+(a.manufacturer?a.manufacturer.data.name+" ":"")+a.line.data.name+"</span><br /><br />"+Sellyx.overflow({text:a.line.data.description,extra:"About "+a.line.label})+'</td><td class="center"><a class="clickable see-all-variations">See All Other '+a.name.label+'(s)</a><br /><br/><button class="add-new-variations btn btn-d-aqua">Add New '+a.name.label+'<i class="fa fa-chevron-right right "></i></button></td></tr>'}},columnDefs:[{visible:!1,targets:m}]})),$("#search_table_container").slideDown()}})}).on("click","#searchTable tbody > tr.group",function(a){Sellyx.dt.order.parent({event:a,table:$("#searchTable"),target:m})}).on("click",".see-variation",function(){var a=Sellyx.row.data($(this)),b='<button class="btn btn-red go-back"><i class="fa  fa-chevron-left"></i>Go Back To Results</button>';Sellyx.ajax.standard({url:"variation",data:"&id="+a.data.id,before:function(){$("#tab1_results").hide(),$("#tab1_product").show(),document.getElementById("tab1_product").innerHTML="<span>Loading product details...</span>"},failure:function(){document.getElementById("tab1_product").innerHTML='<span>There was an error in retrieving the product details.</span><div class="buttons-container">'+b+"</div>"},success:function(c){document.getElementById("tab1_product").innerHTML=c.append+'<br /><br /><div class="buttons-container">'+b+'<button class="btn btn-d-aqua add-this-variation" data-variation="'+a.data.id+'" >Add This '+a.data.name.label+'<i class="fa  fa-chevron-right right"></i></button></div>',$.colorbox.remove(),$(".colorbox-productImage").colorbox({rel:"colorbox-productImage",transition:"none",width:"75%",height:"75%"}),Sellyx.trigger.handles(),$("#search_view").hide()}})}).on("click",".see-all-variations",function(){var a=Sellyx.row.data($(this).parents("tr").next("tr"));console.log(a),Sellyx.ajax.standard({url:"variations",data:"&id="+a.data.line.id,before:function(){$("#tab1_results .results-message").text("Loading all available "+a.data.name.label.toLowerCase()+"(s) for "+(a.data.manufacturer?a.data.manufacturer.data.name+" ":"")+a.data.line.data.name+"..."),$("#search_table_container").hide()},failure:function(){$("#tab1_results .results-message").text("No available "+a.data.name.label.toLowerCase()+"(s) were found for "+(a.data.manufacturer?a.data.manufacturer.data.name+" ":"")+a.data.line.data.name+"."),$("#search_table_container").show()},success:function(b){$("#tab1_results .results-message").text("All available "+a.data.name.label.toLowerCase()+"(s) for "+(a.data.manufacturer?a.data.manufacturer.data.name+" ":"")+a.data.line.data.name+"."),$.fn.DataTable.isDataTable("#variationsTable")?$("#variationsTable").DataTable().clear().rows.add(b).draw():$("#variationsTable").dataTable(Sellyx.dt.init({data:b,ajax:!1,dom:"rtip",autoWidth:!1,columns:[{orderable:!1,data:"images","class":"center",width:"10%",render:function(a){if(a.label){var b=Object.keys(a.data)[0];return'<span>Available In Many Options</span><br/><img src="'+a.data[b][0].small+'"></img><br/><br/><span>Pictured <b>'+b+"</b></span>"}return'<img src="'+a.data[0].small+'"></img>'}},{orderable:!1,data:"name.data",width:"10%"},{orderable:!1,data:"description",width:"60%",render:function(a,b,c){return Sellyx.overflow({text:a,extra:"About "+c.name.label})}},{title:"Actions",orderable:!1,data:"category","class":"center",width:"20%",render:function(a,b,c){return'<a class="clickable see-variation">See Full Product</a><br /><br /><button class="btn btn-d-aqua add-this-variation">Add This '+c.name.label+'<i class="  fa fa-chevron-right right"></i></button></button><br />'}}]})),$("#variations_table_container").slideDown()}})}).on("click",".add-this-variation",function(){var a=Sellyx.row.data($(this));n(2,$(this).data("variation")?$(this).data("variation"):a.data.id),$(".wizard .next").click()}).on("click",".add-new-variations",function(){var a=Sellyx.row.data($(this).parents("tr").next("tr"));n(3,a.data.line.id),$(".wizard .next").click()}).on("click","#back_to_results",function(){$("#tab1_results .results-message").text(""),$("#variations_table_container").hide(),$("#search_table_container").show()}).on("change",".category-select",function(){$this=$(this);var a=2*$this.attr("id");$this.parents(".form-group").nextAll(".add-group").remove();var b=(void 0==$this.val()?"":$this.val()).substring(0,a)+"01",c="000000000000".substring(0,12-b.length),d="";if($.each(Sellyx.vars.categories,function(e,f){e>=parseInt(b+c)&&e<=parseInt(b.substring(0,a)+"99"+c)&&(e.indexOf(c)==b.length||e.indexOf(c)==b.length-1||-1==e.indexOf("00")&&12==b.length)&&(d+='<option value="'+e+'" table="'+f.category_table+'">'+f.category_name+"</option>")}),""!=d){var e=parseInt($this.attr("id"))+1,f='<div class="form-group add-group"><div class="col-sm-7 col-sm-offset-3"><select class="form-control category-select" id="'+e+'">'+d+"</select></div></div>";$(f).insertAfter($this.parents(".form-group")),$("#"+e).trigger("change")}else $('<div class="add-group buttons-container"><button class="btn-next btn btn-d-aqua">Create New Product In '+$("#"+$this.attr("id")+" option:selected").html()+'<i class="fa  fa-chevron-right right"></i></button></div>').insertAfter($this.parents(".form-group")),n(1,$this.val())}).on("click",".add-variation",function(){var d=$(this),e=$(".variations.tab-content .tab-pane.active"),f="var"+Math.floor(1e6*Math.random());$('<div class="tab-pane" id="'+f+'"><div class="buttons-container"><button class="btn btn-d-red delete-variation"><i class="fa fa-close"></i> Delete</button></div>'+c+"</div>").insertAfter(e),$("#listing_variation_select, #image_variation_picker").append('<option value="'+f+'"></option>'),b[f]={},a[f]={},$("#"+f).find(".combination").each(function(){a[f][$(this).data("combo")]={}}),$('<li><a href="#'+f+'" data-toggle="tab"><i class="fa fa-cloud-upload"></i></a></li>').insertBefore(d.parent()),d.parent().prev().find("a").tab("show"),u()}).on("click",".combination-group",function(){if($(this).find("option").length>0){var a=$(this).find("option:selected");document.getElementById("combo_display").innerHTML='<h5 class="bordered">Combination '+a.attr("value")+"</h5>"+Sellyx.factory.quick().displays({data:a.data("info"),l:5,v:7})}}).on("dblclick",".combination-group",function(){if($(this).find("option").length>0){var b=$(this).find("option:selected"),c=$(this).parents(".combination-group-parent").find(".combination-group").not($(this));1==b.length&&($(this).hasClass("chosen")?delete a.current[b.val()]:a.current[b.val()]={},c.append(b[0].outerHTML),$(this).find("option:selected").remove())}u()}).on("click",".delete-variation",function(){var c=$(this);alertify.confirm("Are you sure you wish to delete this variation?",function(d){if(d){var e=c.parents(".tab-pane").attr("id");delete a[e],delete b[e],$('#listing_variation_select option[value="'+e+'"], #image_variation_picker option[value="'+e+'"]').remove();var f=$("#variation_tabs").find('a[href="#'+e+'"]').parent();f.prev().find("a").tab("show"),f.remove(),$("#"+e).remove(),u()}})}).on("click",".add-combo-button",function(){var c=Math.floor(1e13*Math.random()),e=$(this).parents(".tab-pane").attr("id");"current"==e&&"variation"!=g&&0==$('#image_variation_picker option[value="current"]').length&&($("#image_variation_picker").append('<option value="current">'+$('li a[href="#current"]').text()+"</option>"),b[e]={}),a[e][c]={};var f=$('<div class="combination col-sm-6 col-md-4" style="margin-bottom:10px;display:none;" data-combo="'+c+'" ><div style="position:absolute;top:5px;cursor:pointer;right:5px;font-color:red;"><i class="fa fa-close remove-combo-button"></i></div>'+d+"</div>");$(this).parent(".buttons-container").length>0?f.insertBefore($(this).parent(".buttons-container")):(f.insertAfter($(this).parents(".combination")),Sellyx.values.set({data:Sellyx.values.get({divs:$(this).parents(".combination"),html:"data-var",json:!0}),divs:$("#"+e+' .combination[data-combo="'+c+'"]'),html:"data-var"})),f.fadeIn(),u()}).on("click",".remove-combo-button",function(){var c=$(this).parents(".tab-pane").attr("id"),d=$(this).parents(".combination"),e=$(this).parents(".combination").data("combo");delete a[c][e],d.fadeOut(function(){d.remove(),"current"==c&&"variation"!=g&&0==$("#"+c+" .combination").length&&($('#image_variation_picker option[value="current"]').remove(),delete b[c]),u()})}).on("change",'select[data-var="manufacturer"]',function(){0==$(this).val()?($("#add_manufacturer_div").slideDown().find(".form-control").addClass("send validate"),$(this).removeClass("send validate")):($("#add_manufacturer_div").slideUp().find(".form-control").removeClass("send validate"),$(this).addClass("send validate"))}).on("change",".identifier-checkbox",function(){var a=$(this).parents(".input-group-addon").siblings("input");$(this).is(":checked")?a.addClass("validate send").prop("disabled",!1):a.removeClass("validate send").prop("disabled",!0)}).on("change",".identifier-problem",function(){var a=$(this).parents(".combination");$(this).is(":checked")?(a.find('input[data-required="true"]').removeClass("send validate input-error"),$(this).addClass("send")):(a.find('input[data-required="true"]').addClass("send validate"),$(this).removeClass("send"))}).on("click",".additional-attributes",function(){var a=$(this).parent(".buttons-container");$('<div class="form-group additional-attribute-container"><div class="col-xs-5 col-sm-offset-3 col-sm-4"><input type="text" class="form-control validate" placeholder="Enter attribute title here"></div><div class="col-xs-5 col-sm-4"><input type="text" class="form-control validate send" placeholder="Enter attribute value here"></div><div class="col-xs-2 col-sm-1"><i class="fa fa-close fa-2x delete-additional-attribute" style="margin-top:2px;cursor:pointer;"></i></div></div>').insertBefore(a)}).on("click",".delete-additional-attribute",function(){$(this).parents(".additional-attribute-container").remove()}).on("focusout",'input[data-var="name"]',function(){var a=$(this).parents(".tab-pane").attr("id");$('#listing_variation_select option[value="'+a+'"], #image_variation_picker option[value="'+a+'"]').text($(this).val())}).on("change click","#listing_variation_select",function(){$("#listing_combination_select").empty();var b=$(this).val(),c="";"current"==b&&$("#chosen_existing_combinations option").length>0&&$("#chosen_existing_combinations option").each(function(){var a="<option value='"+$(this).attr("value")+"' data-info='"+JSON.stringify($(this).data("info"))+"'>Combination "+$(this).attr("value")+"</option>";c+=a}),$.each(a[b],function(a){if(0!=$("#"+b+' .combination[data-combo="'+a+'"]').length){var d={};$("#"+b+' .combination[data-combo="'+a+'"]').find(".form-control").each(function(){var a=$(this).parents(".input-group").length>0?$(this).parents(".input-group").find(".input-group-addon").text():$(this).parents(".form-group").find(".control-label").text();if("checkbox"!=$(this).prop("type")){if($(this).is("input")){var b=$(this).val();if(""==b.trim())return}else if($(this).is("select"))if("other"!=$(this).val())var b=$(this).find("option:selected").text();else var b=$(this).next().val();d[a]=d[a]?d[a]+", "+b:b}});var e="<option value='"+a+"' data-info='"+JSON.stringify(d)+"'>Combination "+a+"</option>";c+=e}}),$("#listing_combination_select").append(c).val($("#listing_combination_select option:first").attr("value")).trigger("change")}).on("change click","#listing_combination_select",function(){$("#listing_condition_select option").removeClass("option-chosen");var b=$(this).find("option:selected");document.getElementById("listing_combination_details").innerHTML='<h5 class="bordered">Combination '+b.attr("value")+"</h5>"+Sellyx.factory.quick().displays({data:b.data("info"),l:5,v:7}),Object.keys(a[$("#listing_variation_select").val()][$(this).val()]).length>0&&$.each(a[$("#listing_variation_select").val()][$(this).val()],function(a){$('#listing_condition_select option[value="'+a+'"]').addClass("option-chosen")}),$("#listing_condition_select").val("1").trigger("change")}).on("change click","#listing_condition_select",function(){var b=$("#listing_variation_select").val(),c=$("#listing_combination_select").val(),d=$(this).val();$(".shipping-group").each(function(){$(this).find(".enable-shipping").prop("checked",!1).trigger("change"),$(this).find("input").val(""),$(this).find(".shipping-exception").remove()}),$(".shipping-group .enable-shipping").prop("checked",!1).trigger("change"),a[b][c][d]?(Sellyx.values.set({data:a[b][c][d],divs:$("#listing"),html:"data-var"}),2==$('select[data-var="shipping_rates"]').val()&&$.each(a[b][c][d].custom_shipping,function(a,b){var c=$('.shipping-group[service="'+a+'"]');c.find(".enable-shipping").prop("checked",!0).trigger("change");var d=c.find('input[type="text"]');if(d[0].value=b.single,d[1].value=b.with,b.exceptions){var e=c.find(".shipping-exceptions-button");$.each(b.exceptions,function(a,b){e.click();var d=c.find(".shipping-exception:last .form-control");d[0].value=a,d[1].value=b.single,d[2].value=b.with})}}),$("#remove_listing").prop("disabled",!1)):(Sellyx.values.set({data:{},divs:$("#listing"),html:"data-var"}),$("#remove_listing").prop("disabled",!0)),$("#listing_condition_title").text($("#listing_variation_select").find("option:selected").text()+" "+$("#listing_combination_select").find("option:selected").text()+" - "+$(this).find("option:selected").text()),$("#save_listing").prop("disabled",!1)}).on("click","#save_listing",function(){var b=$("#listing_variation_select").val(),c=$("#listing_combination_select").val(),d=$("#listing_condition_select").val();if(Sellyx.validate($("#listing"))){if("2"==$('select[data-var="shipping_rates"]').val()){if((1==$('select[data-var="reach"]').val()||3==$('select[data-var="reach"]').val())&&0==$("#domestic_custom_rates .enable-shipping:checked").length)return alertify.alert("Please pick at least one service for your domestic customers."),!1;if((2==$('select[data-var="reach"]').val()||3==$('select[data-var="reach"]').val())&&0==$("#international_custom_rates .enable-shipping:checked").length)return alertify.alert("Please pick at least one service for your international customers."),!1}a[b][c][d]=Sellyx.values.get({divs:$("#listing"),json:!0,html:"data-var"}),"2"==$('select[data-var="shipping_rates"]').val()&&(a[b][c][d].custom_shipping={},$(".shipping-group .enable-shipping:checked").each(function(){var e=$(this).parent(".input-group-addon").siblings("input"),f=$(this).parents(".shipping-group"),g=f.attr("service");a[b][c][d].custom_shipping[g]={single:e[0].value,"with":e[1].value};var h=f.find(".shipping-exception");h.length>0&&(a[b][c][d].custom_shipping[g].exceptions={},$.each(h,function(){var e=$(this).find(".form-control");a[b][c][d].custom_shipping[g].exceptions[e[0].value]={single:e[1].value,"with":e[2].value}}))})),console.log(a[b][c][d]),$("#remove_listing").prop("disabled",!1),$("#listing_condition_select option:selected").addClass("option-chosen"),alertify.success("Saved!")}}).on("click","#remove_listing",function(){var b=$("#listing_variation_select").val(),c=$("#listing_combination_select").val(),d=$("#listing_condition_select").val();delete a[b][c][d],console.log(a),alertify.error("Listing removed."),$("#remove_listing").prop("disabled",!0),$("#listing_condition_select option:selected").removeClass("option-chosen")}).on("change",'select[data-var="local.listing"]',function(){1==$(this).val()?$("#local_listing_div").hide().find(".form-control").removeClass("validate"):$("#local_listing_div").show().find(".form-control").addClass("validate")}).on("change click","#image_variation_picker",function(){var a=$(this).val();if("variation"==g)v(a);else{var c="",d=[];$.each($("#"+a+" .combination"),function(){var e=$(this).find('.form-control[data-var="'+g+'"]');if(e.is("input"))var f=h=e.val();else if(e.is("select"))if("other"==e.val())var f=h=e.siblings("input").val();else var f=e.val(),h=e.find("option:selected").text();-1===$.inArray(f,d)&&(void 0==b[a][f]?b[a][f]={}:null,c+='<option value="'+f+'">'+h+"</option>",d.push(f))}),document.getElementById("image_final_picker").innerHTML=c,$("#image_final_picker").val($("#image_final_picker option:first").val()).trigger("change")}}).on("change click","#image_final_picker",function(){v($(this).val())}).on("change click","#image_seller_picker",function(){if(0!=t.getUploadingFiles().length)return alertify.error("Please wait until all your files have finished uploading before changing this option."),!1;var a=$(this).find("option:selected");document.getElementById("image_seller_title").innerHTML=a.text(),$("#sellerImages").find(".dz-preview").remove(),t.files=[],l[a.attr("value")]&&Object.keys(l[a.attr("value")]).length>0&&$.each(l[a.attr("value")],function(a,b){var c={name:a,size:b.size,accepted:"true",status:"success"};t.options.addedfile.call(t,c),t.options.thumbnail.call(t,c,b.name.replace("public","")),t.files.push(c)})}).on("click",".finish",function(){var b=p();if(!b)return!1;var c="&type="+e+"&value="+f;c+=1==e||2==e?"&line="+encodeURIComponent(JSON.stringify(Sellyx.values.get({divs:$("#line_information"),html:"data-var",json:!0})))+"&variations="+encodeURIComponent(JSON.stringify(o()))+"&listings="+encodeURIComponent(JSON.stringify(a)):3==e||4==e?"&line="+f+"&variations="+encodeURIComponent(JSON.stringify(o()))+"&listings="+encodeURIComponent(JSON.stringify(a)):"&product="+f+"&listings="+encodeURIComponent(JSON.stringify(a)),c+="&images="+JSON.stringify(l),0!==c?Sellyx.ajax.standard({block:$(".manager-container"),lang:h.ajax.submit,url:"finish",data:c,success:function(){Sellyx.path.redirect.now({path:"/manager/seller/inventory/home"})}}):alertify.alert(h.ajax.submit.error)});var u=function(){var a=!1,b=$(".tab-content.variations").find(".tab-pane");$.each(b,function(){return $(this).find(".combination-group").length>0&&$(this).find(".combination-group.chosen option").length>0?(a=!0,!1):$(this).find(".combination").length>0?(a=!0,!1):void 0}),a?$("#product").find(".btn-next").show():$("#product").find(".btn-next").hide()},v=function(a){if($("#productImages").find(".dz-preview").remove(),s.files=[],"variation"==g)var c=b[a];else var c=b[$("#image_variation_picker").val()][a];c&&Object.keys(c).length>0&&$.each(c,function(a,b){var c={name:a,size:b.size,accepted:"true",status:"success"};s.options.addedfile.call(s,c),s.options.thumbnail.call(s,c,b.name.replace("public","")),s.files.push(c)})};$(".category-select").trigger("change"),$("#aW").bootstrapWizard({onNext:function(b,h,i){switch(i){case 1:if(!e||!f)return alertify.alert("Oops! Please select a product that you want to add before going to the next step in the wizard."),!1;if(!j)return!0;var l="&type="+e;switch(parseInt(e)){case 1:case 2:l+="&category="+f+"&variation="+$("#do_what").val();break;case 3:case 4:l+="&id="+f}var m='<div class="buttons-container no-bottom border-top"><button class="btn-prev btn btn-red"><i class="fa-chevron-left fa "></i>Go Back to Search</button>';return Sellyx.ajax.standard({data:l,url:"form",before:function(){document.getElementById("product").innerHTML='<div class="buttons-container"><span>Loading product form...</span></div>'},failure:function(){k=!1,document.getElementById("product").innerHTML='<div style="text-align:center"><span>There was an error loading the product form.</span>'+m+"</div>"},success:function(a){if(k=!0,document.getElementById("product").innerHTML=a.string+m+'<button class="btn btn-d-aqua btn-next" style="display:none;">Create Listings<i class="fa fa-chevron-right right "></i></button></div>',g=a.images,1==e){var b={0:"Add New..."};Sellyx.ajax.standard({data:"&category="+f,url:"/corporate/master/lines/manufacturers",success:function(){b=$.extend(b,a,!0)},always:function(){$('select[data-var="manufacturer"]').empty().append(Sellyx.generate.options(b)).trigger("change")}})}"variation"==g?$("#image_final_picker").prop("disabled",!0).empty().hide():$("#image_final_picker").prop("disabled",!1).empty().show(),c=$("#var1").html(),d=$('#var1 .combination[data-combo="1"]').html(),3==e&&($.colorbox.remove(),$(".colorbox-productImage").colorbox({rel:"colorbox-productImage",transition:"none",width:"75%",height:"75%"}),$("#var1").remove(),$('li a[href="#var1"]').remove(),$(".combination").remove()),$("#variation_tabs a:first").tab("show"),u(),j=!1}}),!0;case 2:return k?(3==e&&(0==Object.keys(a.current).length?$('#listing_variation_select option[value="current"]').remove():0==$('#listing_variation_select option[value="current"]').length?$("#listing_variation_select").append('<option value="current">'+$('li a[href="#current"]').text()+"</option>"):null),0==$("#listing_variation_select option").length?(alertify.alert("Oops! You must add at least one variation and one combination to continue with this listing."),!1):($("#listing_variation_select").val($("#listing_variation_select option:first").attr("value")).trigger("change"),Sellyx.validate($("#product"),!0))):(alertify.alert("Oops! It seems like there was an error loading the product form. Please either press the back button and try again or reload the page. If you keep seeing this error, please contact Sellyx immediately."),!1);case 3:return 0==$("#image_variation_picker option").length?($("#product_images_div").hide(),s.disable()):($("#product_images_div").show(),s.enable(),$("#image_variation_picker").val($("#image_variation_picker option:first").attr("value")).trigger("change")),q();case 4:return p()}return!0},onTabShow:function(a,b,c){b.find("li").length<=c+1?($("#aW").find(".pager .next").hide(),$("#aW").find(".pager .finish").show()):($("#aW").find(".pager .next").show(),$("#aW").find(".pager .finish").hide())},onTabClick:function(){return!1}}),$("#do_what").val(1).trigger("change")});