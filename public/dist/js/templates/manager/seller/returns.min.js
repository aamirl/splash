$(document).on("ready",function(){{var a=s_lang.manager_seller_returns,b=!1;$("#returnTable").dataTable(Sellyx.dt.init({columns:[{orderable:!1,data:null,defaultContent:'<i class="fa fa-lg fa-plus-circle child-details-control"></i>',"class":"center"},{title:a.tables.active.columns.placed,data:"setup.added.label","class":"center"},{title:a.tables.active.columns.user,data:"user","class":"center",render:function(a){return'<a href="/world/user/'+a.id+'" target="_blank" onclick="event.stopImmediatePropagation()">'+a.name+"</a>"}},{title:a.tables.active.columns.item,data:"item.item","class":"center",render:function(a,b,c){return"<label>Order</label><span> "+c.order+'</span><br /><a href="/world/product/'+a.id+"?&listing="+c.item.listing+'" target="_blank" onclick="event.stopImmediatePropagation()">'+a.name+"</a>"}},{title:a.tables.active.columns.actions,data:"setup.status","class":"center",render:function(a){var b="<span>"+a.label+"</span>";return 5==a.id&&(b+='<br/><a class="clickable confirm-return-button">Confirm Item Received</a>'),b}},{title:a.tables.active.columns.id,data:"id","class":"center"}],ajax:"returns",rowCallback:function(a,b){switch($(a).addClass("return-row").data("return",b.id),b.setup.status.id){case 1:$(a).addClass("row-error");break;case 3:case 4:case 5:$(a).addClass("row-intermediate-success");break;case 0:case 6:case 7:$(a).addClass("row-intermediate-error");break;case 100:$(a).addClass("row-success")}}}))}$(document).on("shown.bs.tab",'a[href="#policy"]',function(){b||Sellyx.ajax.standard({url:"policy",lang:a.ajax.policy,block:$("#policy"),always:function(){b=!0},success:function(a){a&&(Sellyx.values.set({data:a[1],divs:$('.col-sm-6[data-var="1"]'),html:"data-var"}),Sellyx.values.set({data:a[2],divs:$('.col-sm-6[data-var="2"]'),html:"data-var"}),$(".allow-master").trigger("change"))}})}).on("change",".allow-master",function(){var a=2==$(this).val()?!0:!1;$(this).parents(".col-sm-6").find(".send").not($(this)).not(".nr").each(function(){a?$(this).addClass("validate").prop("disabled",!1):$(this).removeClass("validate input-error").prop("disabled",!0)})}).on("click",".save-button",function(){if(Sellyx.validate($('.col-sm-6[data-var="1"]'))&&Sellyx.validate($('.col-sm-6[data-var="2"]'))){var b={1:JSON.stringify(Sellyx.values.get({divs:$('.col-sm-6[data-var="1"]'),html:"data-var",json:!0})),2:JSON.stringify(Sellyx.values.get({divs:$('.col-sm-6[data-var="2"]'),html:"data-var",json:!0}))};Sellyx.ajax.standard({url:"save",button:$(this),data:b,lang:a.ajax.save,success:function(){$(document).find(".return-panel").length>0&&$(".return-panel").remove()}})}}).on("click","#returnTable tbody > tr.odd , #returnTable tbody > tr.even",function(a){a.stopImmediatePropagation();var b=Sellyx.row.data($(this)),c=b.data,d='<tr><td colspan="2" class="form-horizontal">'+Sellyx.factory.quick().displays({data:c.item.totals,l:5,v:7})+"</td>";d+='<td colspan="2"><div class="padded" style="border:1px solid #DDD;"><span>Returning '+c.quantity+"/"+c.item.quantity+" Total Items</span><br /><span>"+c.reason.label+"</span><br /><label>"+(c.details?c.details:"")+'</label></div><br /><i class="fa fa-fw fa-user s-d-yellow"></i><span> '+c.policy.shipping+'</span><br /><i class="fa fa-fw fa-money s-d-green"></i><span> '+c.policy.type+"</span>"+(c.policy.details?"<br /><br /><label>"+c.policy.details+"</label>":"")+'</td><td colspan="2">',1==c.setup.status.id?d+='<div class="return-box" style="margin-top:10px;"><select data-var="accepted" class="form-control send validate"><option value="2">Return Accepted</option><option value="1">Return Not Being Accepted</option></select><input type="text" class="form-control data-decimal send validate" placeholder="Total Returned" data-var="total" /><textarea style="resize:none;height:75px;" class="form-control send" placeholder="Additional Details (Optional)" data-var="details"></textarea><div class="buttons-container"><button class="process-return-button">Process Return</button></div></div>':c.processed&&(d+='<span class="s-d-red">'+c.processed.accepted+"</span><span> | "+c.processed.added+"</span><br />"+(c.processed.total?"<label>Refund Amount</label> <span> "+c.processed.total+"</span>":"")+(c.processed.details?"<br /><label>"+c.processed.details+"</label>":"")),c.shipped&&(d+='<div style="margin-top:10px;"><i class="fa fa-fw fa-plane s-d-blue"></i><span> Shipped via '+c.shipped.courier+" [ "+c.shipped.tracking+" ]</span><br /><span>"+c.shipped.added+"</span>"+(c.shipped.details?"<br /><label>"+c.shipped.details+"</label>":"")+"</div>"),c.received&&(d+='<br /><div style="font-weight:bold;font-size:11px;"><i class="fa fa-fw fa-check-circle s-d-aqua"></i><span> Return Completed | '+c.received.added+"</span>"),Sellyx.dt.child({all:b,ins:d+"</tr>",table:!0})}).on("change",'select[data-var="accepted"]',function(){1==$(this).val()?$(this).next("input").prop("disabled",!0).removeClass("send validate input-error").hide():$(this).next("input").prop("disabled",!1).addClass("send validate").show()}).on("click",".process-return-button",function(b){b.stopImmediatePropagation();var c=$(this).parents("tr").prev(".return-row");Sellyx.ajax.standard({url:"process",button:$(this),container:{divs:$(this).parents(".return-box"),html:"data-var"},lang:a.ajax.process,data:"&id="+c.data("return"),update:{merge:!0,child:!0,row:c}})}).on("click",".confirm-return-button",function(b){b.stopImmediatePropagation();var c=$(this).parents("tr");Sellyx.ajax.standard({url:"confirm",button:$(this),lang:a.ajax.confirm,data:"&id="+c.data("return"),update:{merge:!0,row:c}})})});