$(document).on("ready",function(){var a=s_lang.manager_corporate_lines,b=$("#lineTable").data("corporate")?!0:!1,c=$("#lineTable").data("approvals")?!0:!1,d=($("#lineTable").dataTable(Sellyx.dt.init({columns:[{orderable:!1,data:null,defaultContent:'<i class="fa fa-lg fa-plus-circle line-details-control"></i>',"class":"center"},{title:a.tables.active.columns.name,data:"name","class":"center"},{title:a.tables.active.columns.category,data:"category.label","class":"center"},{title:a.tables.active.columns.added,data:"setup.added.label","class":"center"},{title:a.tables.active.columns.manufacturer,data:"name","class":"center",render:function(a,b,c){return c.manufacturer?'<span><a href="/world/manufacturer/'+c.manufacturer.id+'" target="_blank">'+c.manufacturer.name+"</a></span>":"<span>Custom</span>"}},{title:a.tables.active.columns.actions,data:"setup.status","class":"center",render:function(a,c,d){if(!b&&1==d.setup.locked)return"<span>"+a.label+"</span>";var e={status:a.label,buttons:[],go:[1],id:a.id};return 1==a.id?e.buttons.push('<a class="clickable change-status-button" data-path="/corporate/master/lines/" data-status="'+(b?0:2)+'"><i class="fa fa-minus-circle"></i> Deactivate Line</a>'):(2==a.id||b&&0==a.id)&&e.buttons.push('<a data-path="/corporate/master/lines/"  class="clickable change-status-button" data-path="/corporate/master/lines/" data-status="1"><i class="fa fa-plus-circle"></i> Reactivate Line</a>'),(0==d.setup.locked||b)&&e.buttons.push('<a data-path="/corporate/master/lines/"  class="clickable edit-line-button"><i class="fa fa-edit"></i> Edit Product Line</a>'),b&&(e.buttons.push("divider"),e.buttons.push(0==d.setup.locked?'<a class="clickable change-status-button" data-path="/corporate/master/lines/"  data-status="1" data-extra="locked"><i class="fa fa-lock"></i> Lock</a>':'<a class="clickable change-status-button" data-status="0" data-path="/corporate/master/lines/"  data-extra="locked"><i class="fa fa-unlock"></i> Unlock</a>')),Sellyx.dt.actions(e)}}],order:[[2,"desc"]],ajax:{url:"/corporate/master/lines/lines",data:function(a){b&&(a.corporate=!0),c&&(a.approvals=!0)}}})),null),e=null;$(document).on("change",'select[data-var="custom"]',function(){1==$(this).val()?($("#manufacturer_div").show(),$('select[data-var="manufacturer"]').trigger("change").parents(".form-group").show()):($("#manufacturer_div").hide(),$('select[data-var="manufacturer"]').removeClass("send validate").parents(".form-group").hide())}).on("change",'select[data-var="manufacturer"]',function(){0==$(this).val()?($(this).removeClass("send validate"),$("#add_manufacturer_div").show().find(".form-control").addClass("send validate")):($(this).addClass("send validate"),$("#add_manufacturer_div").hide().find(".form-control").removeClass("send validate"))}).on("click","#lineModal .save-button",function(){Sellyx.ajax.standard({url:"/corporate/master/lines/update",button:$(this),data:"&id="+d.data.id,container:{divs:$("#lineModal"),html:"data-var"},update:{row:d.row}})}).on("click",".line-details-control , #lineTable tbody > tr.odd , #lineTable tbody > tr.even",function(a){a.stopImmediatePropagation();var b=Sellyx.row.data($(this)),c=b.data;if(b.dtrow.child.isShown())b.dtrow.child.hide(),b.row.find(".line-details-control").addClass("fa-plus-circle").removeClass("fa-minus-circle");else{var d='<table class="child-table" cellpadding="5" cellspacing="0" border="0" style="width:100%;"><tbody><tr><td colspan="3"><div style="text-align:center;"><span>'+c.description+"</span></div><br />";b.row.find(".line-details-control").removeClass("fa-plus-circle").addClass("fa-minus-circle"),b.dtrow.child(d+"</td></tr></tbody></table>").show()}}).on("click",".edit-line-button",function(a){a.stopImmediatePropagation();var b=Sellyx.row.data($(this));$("#manufacturer_div").find(".form-control").removeClass("send validate"),Sellyx.values.set({divs:$("#lineModal"),html:"data-var",data:b.data}),Sellyx.ajax.standard({url:"/corporate/master/lines/form",button:$(this),data:"&id="+b.data.category.id,success:function(a){d=b,a.line&&($('input[data-var="name"]').attr("placeholder",a.line.name.placeholder).parent("div").prev("label").text(a.line.name.label),$('input[data-var="description"]').attr("placeholder",a.line.description.placeholder).parent("div").prev("label").text(a.line.name.label+" Details")),e=a.manufacturer,f(1==b.data.custom?!0:!1),$("#lineModal").modal("show")}})});var f=function(a){$('select[data-var="manufacturer"]').parent("div").prev("label").text(e.label),$('input[data-var="manufacturer.name"]').parent("div").prev("label").text(e.label),$("#add_manufacturer_div h6").text("Add "+e.label),$.ajax({data:"&category="+d.data.category.id,url:"/corporate/master/lines/manufacturers",type:"post"}).done(function(b){var c={0:"Add New..."};b.success&&(c=$.extend(c,b.success,!0)),$('select[data-var="manufacturer"]')[0].innerHTML=Sellyx.generate.options(c),d.data.manufacturer&&$('select[data-var="manufacturer"]').val(d.data.manufacturer.id).trigger("change"),a?$("#manufacturer_div").show():$("#manufacturer_div").hide()})}});